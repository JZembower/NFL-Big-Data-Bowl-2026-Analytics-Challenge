# NFL Pass Play Analytics & Modeling Suite  
**Predicting Pass Completion and Player Post-Snap Trajectories using Next Gen Stats (2023 Season)**  

![Python](https://img.shields.io/badge/python-3.9%2B-blue) ![Pandas](https://img.shields.io/badge/pandas-2.1%2B-green) ![PyTorch](https://img.shields.io/badge/PyTorch-2.1%2B-red) ![scikit--learn](https://img.shields.io/badge/scikit--learn-1.3%2B-orange)  

A complete end-to-end pipeline that goes from raw NFL Next Gen Stats tracking data → rich feature engineering → two state-of-the-art modeling tasks:

1. **Pass Completion Prediction** (classic ML)  
2. **Post-Snap Player Trajectory Forecasting** (deep learning / Transformer)

Built with reproducibility, modularity, and extensibility in mind.

---

## Project Structure

```
nfl-pass-analytics/
├── notebooks/                     # Main analysis & modeling scripts
│   ├── 01_eda.ipynb                  # Exploratory Data Analysis + visualizations
│   ├── 02_features.ipynb             # Full enhanced feature engineering pipeline
│   ├── 03_modeling_routes.ipynb      # Transformer-based trajectory forecasting
│   └── 04_modeling_completions.ipynb # Pass completion classifier (XGBoost, RF, etc.)
│
├── src/
│   └── feature_engineering.py     # Reusable, clean functions (auto-generated by 02_feature.ipynb)
│
├── data/
│   ├── raw/                       # Original competition files weeks 1-18
│   │   ├── input_2023_w??.csv
│   │   ├── output_2023_w??.csv
│   │   └── supplementary_data.csv
│   ├── processed/                 # Enhanced parquet files + deep-learning artifacts
│   └── splits/                    # (optional) train/val week splits
│
├── models/                        # Completion model pickles + plots
├── visualizations/                # All EDA & feature plots
│
├── requirements.txt
└── README.md
```

---

## What the Project Does

| Notebook | Goal | Key Output |
|----------|------|------------|
| **01_eda.ipynb** | Understand the raw data, distributions, missingness, spatial patterns | 12+ high-quality plots, key insights summary |
| **02_features.ipynb** | Create ~140 engineered features (kinematics, coverage, game situation, route intelligence, physics-based) | `features_enhanced_w??.parquet` + reusable `src/feature_engineering.py` |
| **03_modeling_routes.ipynb** | Predict the next 20–25 frames of every player’s (x,y) trajectory after the pass is thrown | Transformer model, ADE/FDE metrics, beautiful trajectory visualizations |
| **04_modeling_completions.ipynb** | Binary classification: Will the pass be completed? | XGBoost / RandomForest / Logistic Regression comparison, confusion matrix, feature importance |

---

## Key Innovations & Features

- **Relative-to-anchor trajectory prediction** – eliminates absolute coordinate drift and dramatically improves training stability  
- **140+ engineered features** including:
  - Smoothed kinematics (speed, acceleration, jerk, turn rate)
  - Separation & coverage metrics (nearest defender, player density)
  - Game-situation flags (2-minute drill, red zone, 3rd-and-long, close game, etc.)
  - Route intelligence (historical completion rate by route, dropback depth)
  - Physics-based features (velocity vectors, momentum, kinetic energy proxy)
- **Modular, production-ready feature engineering** in `src/feature_engineering.py`
- **Both classic ML and modern deep learning** approaches in the same repo
- Full reproducibility – every plot, model, and metric is saved automatically

---

## Quick Start

```bash
# 1. Clone the repo (or download the files)
git clone https://github.com/yourname/nfl-pass-analytics.git
cd nfl-pass-analytics

# 2. Create environment
conda create -n nfl python=3.10 -y
conda activate nfl

# 3. Install dependencies
pip install -r requirements.txt

# For GPU (recommended for trajectory model)
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121
```

### Run the full pipeline

```bash
# Place raw CSV files in data/raw/
# Then execute in order:

python notebooks/01_eda.ipynb
python notebooks/02_features.ipynb          # creates enhanced parquet files
python notebooks/03_modeling_routes.ipynb   # trains Transformer (≈4-20 hours on GPU)
python notebooks/04_modeling_completions.ipynb # gives pass completion models
```

All models, plots, and processed data will appear in `models/`, `visualizations/`, and `data/processed/`.

---

## Sample Results (as of Dec 2025 run)

**Trajectory Forecasting (03)**  
- Validation ADE: **~1.8 yards**  
- Validation FDE: **~3.4 yards**  
- Model: Lite Transformer (3 layers, 4 heads, hidden=128)

**Pass Completion Prediction (04)**  
| Model               | Test Accuracy | F1-Score | AUC-ROC |
|---------------------|---------------|----------|---------|
| XGBoost             | 78.4%         | 0.812    | 0.862   |
| Random Forest       | 77.9%         | 0.805    | 0.854   |
| Logistic Regression | 76.2%         | 0.789    | 0.841   |

Top completion predictors:  
`receiver_separation`, `qb_target_distance`, `target_nearest_defender`, `route_completion_rate`, `pass_length`, `defenders_in_the_box`

---

## Future Ideas / Extensions

- Multi-task model (completion + trajectory)
- Player-specific models (WR vs TE vs RB)
- Real-time inference endpoint
- Integration with EPA / win probability models

---

## Acknowledgments

Built using the **NFL Big Data Bowl 2023** dataset (tracking + play-level data).  
Massive thanks to the NFL, Next Gen Stats, and Kaggle for making this incredible data public.

---

— *Jonah Zembower / Heinz Sports Analytics Club*  
December 4, 2025